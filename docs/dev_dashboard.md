# Smart Home Dashboard - å¼€å‘è®¡åˆ’

> æœ¬æ–‡æ¡£æ˜¯ PRD + RFC + Refactor Plan çš„åˆä½“ï¼Œå®šä½å½“å‰å·¥ç¨‹è´¨é‡ Gap å¹¶è§„åˆ’ Dashboard å¯è§†åŒ–æ–¹æ¡ˆã€‚

---

## ä¸€ã€ç°çŠ¶è¯„ä¼°

### 1.1 å·²é›†æˆçš„è®¾å¤‡

| è®¾å¤‡ç±»å‹ | æ•°é‡ | çŠ¶æ€ | API æ–¹å¼ |
|---------|------|------|---------|
| Hue ç¯å…‰ | 3 ç› | æ­£å¸¸ | æœ¬åœ° API (phue) |
| Wemo å¼€å…³ | 4 ä¸ª | æ­£å¸¸ | SSDP å‘ç° + UPnP (pywemo) |
| Rinnai çƒ­æ°´å™¨ | 1 å° | æ­£å¸¸ | äº‘ç«¯ GraphQL (aiorinnai) |
| Meross è½¦åº“é—¨ | 1 å° (3 é—¨) | æ­£å¸¸ | äº‘ç«¯ MQTT (meross-iot) |

### 1.2 ç°æœ‰åŠŸèƒ½

**Hue:**
- ç¯å…‰å¼€å…³æ§åˆ¶
- äº®åº¦è°ƒèŠ‚
- å®šæ—¶å…³ç¯ (timer-based)
- çŠ¶æ€æŸ¥è¯¢

**Wemo:**
- å¼€å…³æ§åˆ¶
- è®¾å¤‡å‘ç° (SSDP)
- å®šæ—¶ä»»åŠ¡è°ƒåº¦ (APScheduler + YAML config)
- çŠ¶æ€æŸ¥è¯¢

**Rinnai:**
- æ¸©åº¦è®¾ç½®/è¯»å–
- å¼€å…³æ§åˆ¶
- å¾ªç¯æ¨¡å¼æ§åˆ¶
- Schedule ç®¡ç† (é€šè¿‡ GraphQL mutation)
- ä¼ æ„Ÿå™¨æ•°æ®è¯»å– (è¿›/å‡ºæ°´æ¸©åº¦ã€æ°´æµé‡ç­‰)

**Meross (MSG200):**
- è½¦åº“é—¨å¼€å…³æ§åˆ¶ (æ”¯æŒ 3 é—¨)
- é—¨çŠ¶æ€æŸ¥è¯¢ (å¼€/å…³)
- äº‘ç«¯ MQTT é€šä¿¡

---

## äºŒã€å·¥ç¨‹è´¨é‡ Gap åˆ†æ

### 2.1 æ¶æ„é—®é¢˜

| é—®é¢˜ | ç°çŠ¶ | é£é™©ç­‰çº§ | å»ºè®® |
|-----|------|---------|------|
| **æ— ç»Ÿä¸€æ•°æ®æ¨¡å‹** | ä¸‰ä¸ªè®¾å¤‡å„è‡ªç‹¬ç«‹å®ç°ï¼Œæ— æŠ½è±¡å±‚ | é«˜ | å¼•å…¥ `Device` åŸºç±» + è®¾å¤‡ç±»å‹æšä¸¾ |
| **çŠ¶æ€ç®¡ç†åˆ†æ•£** | å…¨å±€å˜é‡ + ad-hoc ç¼“å­˜ | é«˜ | å¼•å…¥ç»Ÿä¸€çš„çŠ¶æ€å­˜å‚¨ (å¯è€ƒè™‘ Redis/å†…å­˜ dict) |
| **é…ç½®åˆ†æ•£** | .env + wemo_config.yaml + hardcode | ä¸­ | ç»Ÿä¸€ä½¿ç”¨ YAML æˆ– pydantic-settings |
| **æ—  WebSocket/SSE** | çº¯ REST è½®è¯¢ | ä¸­ | æ·»åŠ  SSE æ¨é€è®¾å¤‡çŠ¶æ€å˜æ›´ |
| **é”™è¯¯å¤„ç†ä¸å®Œå–„** | try-catch + log | ä¸­ | å¼•å…¥ç»“æ„åŒ–é”™è¯¯ç  + é‡è¯•æœºåˆ¶ |
| **æ— è®¤è¯/é‰´æƒ** | API å®Œå…¨å¼€æ”¾ | é«˜ | æ·»åŠ  API Key æˆ– OAuth (å†…ç½‘å¯æ”¾å®½) |
| **æ—¥å¿—è¿‡äºå†—ä½™** | DEBUG çº§åˆ«å…¨å¼€ | ä½ | åˆ†çº§æ—¥å¿—ï¼Œç”Ÿäº§ç¯å¢ƒé»˜è®¤ INFO |
| **phue åº“å…¼å®¹æ€§è­¦å‘Š** | SyntaxWarning | ä½ | è€ƒè™‘ fork ä¿®å¤æˆ–è¿ç§»åˆ° hue-api |

### 2.2 æµ‹è¯•è¦†ç›–

- å•å…ƒæµ‹è¯•: å­˜åœ¨ä½†æœªè¦†ç›–æ‰€æœ‰æ¨¡å—
- é›†æˆæµ‹è¯•: ä¾èµ–çœŸå®è®¾å¤‡ï¼Œæ—  mock
- E2E æµ‹è¯•: æ— 

### 2.3 æ–‡æ¡£çŠ¶æ€

- README.md: å­˜åœ¨ï¼Œä½†æœªè¦†ç›– Rinnai
- rinnai_skills.md: è¯¦ç»†ï¼Œä½†ä¸ä¸» README åˆ†ç¦»
- API æ–‡æ¡£: FastAPI è‡ªåŠ¨ç”Ÿæˆï¼Œä½†æ— ä¸šåŠ¡è¯´æ˜

### 2.4 éƒ¨ç½²çŠ¶æ€

- å½“å‰: æ‰‹åŠ¨è¿è¡Œ `start_server.sh`
- æ—  systemd/launchd æœåŠ¡åŒ–
- æ—  Docker åŒ–
- æ— å¥åº·æ£€æŸ¥ç«¯ç‚¹

---

## ä¸‰ã€Dashboard éœ€æ±‚è®¾è®¡

### 3.1 æ ¸å¿ƒç”¨æˆ·åœºæ™¯

1. **ä¸€çœ¼çœ‹å…¨**: åœ¨ä¸€ä¸ªé¡µé¢çœ‹åˆ°æ‰€æœ‰è®¾å¤‡çŠ¶æ€
2. **å¿«é€Ÿæ§åˆ¶**: ä¸€é”®å¼€å…³/è°ƒèŠ‚è®¾å¤‡
3. **å®šæ—¶ç®¡ç†**: å¯è§†åŒ–æŸ¥çœ‹/ç¼–è¾‘å®šæ—¶ä»»åŠ¡
4. **å†å²è¶‹åŠ¿**: æŸ¥çœ‹æ¸©åº¦ã€ç”¨ç”µç­‰å†å²æ•°æ®
5. **å¼‚å¸¸å‘Šè­¦**: è®¾å¤‡ç¦»çº¿ã€æ¸©åº¦å¼‚å¸¸ç­‰æ¨é€

### 3.2 ç•Œé¢è®¾è®¡

#### 3.2.1 æ•´ä½“å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ  Smart Home Dashboard              [ç”¨æˆ·] [è®¾ç½®] [å¸®åŠ©]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  ğŸ’¡ ç¯å…‰        â”‚  â”‚  ğŸ”Œ å¼€å…³        â”‚                  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                  â”‚
â”‚  â”‚  Baby Room  [â—‹] â”‚  â”‚  Coffee    [â—]  â”‚                  â”‚
â”‚  â”‚  Hue Lamp 1 [â—] â”‚  â”‚  Veggie    [â—]  â”‚                  â”‚
â”‚  â”‚  Hue Lamp 2 [â—] â”‚  â”‚  Tree      [â—‹]  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  Bedroom   [â—‹]  â”‚                  â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸš¿ çƒ­æ°´å™¨ (Main House)                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  è®¾å®šæ¸©åº¦: [125Â°F] â–¼    å½“å‰çŠ¶æ€: â— è¿è¡Œä¸­          â”‚   â”‚
â”‚  â”‚  è¿›æ°´æ¸©åº¦: 103Â°F       å‡ºæ°´æ¸©åº¦: 121Â°F              â”‚   â”‚
â”‚  â”‚  æ°´æµé‡: 26            ç‡ƒçƒ§å¾ªç¯: 1 æ¬¡               â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  å®šæ—¶ä»»åŠ¡:                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€ MorningShower  07:30-08:15  æ¯å¤© âœ“             â”‚   â”‚
â”‚  â”‚  â”œâ”€ AfternoonPeak  16:30-18:00  æ¯å¤© âœ“             â”‚   â”‚
â”‚  â”‚  â””â”€ NightShower    20:30-23:00  æ¯å¤© âœ“             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸš— è½¦åº“é—¨ (MSG200)                                 â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  Garage Door 1  [â— OPEN]   [å…³é—­]                   â”‚   â”‚
â”‚  â”‚  Garage Door 2  [â— OPEN]   [å…³é—­]                   â”‚   â”‚
â”‚  â”‚  Garage Door 3  [â— OPEN]   [å…³é—­]                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ“Š è¶‹åŠ¿å›¾ (æœ€è¿‘ 24 å°æ—¶)                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  [æ¸©åº¦æ›²çº¿] [ç”¨æ°´é‡] [ç”¨ç”µé‡]                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚         ğŸ“ˆ å›¾è¡¨åŒºåŸŸ                          â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.2 é¡µé¢ç»“æ„

| é¡µé¢ | åŠŸèƒ½ | ä¼˜å…ˆçº§ |
|-----|------|-------|
| **Dashboard (é¦–é¡µ)** | è®¾å¤‡æ€»è§ˆ + å¿«é€Ÿæ§åˆ¶ | P0 |
| **è®¾å¤‡è¯¦æƒ…** | å•è®¾å¤‡è¯¦ç»†æ§åˆ¶ + å†å² | P1 |
| **å®šæ—¶ä»»åŠ¡** | å¯è§†åŒ–ä»»åŠ¡ç®¡ç† | P1 |
| **è®¾ç½®** | ç³»ç»Ÿ/è®¾å¤‡é…ç½® | P2 |
| **æ—¥å¿—** | æ“ä½œæ—¥å¿—æŸ¥çœ‹ | P2 |

### 3.3 åŠŸèƒ½æ¨¡å—

#### P0 - MVP

- [ ] ç»Ÿä¸€çŠ¶æ€ API (`GET /api/status`)
- [ ] è®¾å¤‡æ§åˆ¶ API ç»Ÿä¸€åŒ–
- [ ] å‰ç«¯ Dashboard é¡µé¢
- [ ] å®æ—¶çŠ¶æ€åˆ·æ–° (SSE æˆ–è½®è¯¢)
- [ ] ç§»åŠ¨ç«¯é€‚é…

#### P1 - å¢å¼º

- [ ] å®šæ—¶ä»»åŠ¡å¯è§†åŒ–ç¼–è¾‘
- [ ] å†å²æ•°æ®å­˜å‚¨ (SQLite/InfluxDB)
- [ ] æ¸©åº¦/ç”¨ç”µè¶‹åŠ¿å›¾
- [ ] è®¾å¤‡åˆ†ç»„/åœºæ™¯
- [ ] é€šçŸ¥æ¨é€ (Web Push / é‚®ä»¶)

#### P2 - å®Œå–„

- [ ] å¤šç”¨æˆ·æ”¯æŒ
- [ ] æƒé™ç®¡ç†
- [ ] è¯­éŸ³æ§åˆ¶é›†æˆ (Home Assistant å…¼å®¹)
- [ ] è‡ªåŠ¨åŒ–è§„åˆ™å¼•æ“
- [ ] æ•°æ®å¯¼å‡º

### 3.4 æŠ€æœ¯é€‰å‹å»ºè®®

| å±‚çº§ | é€‰é¡¹ A (æ¨è) | é€‰é¡¹ B | ç†ç”± |
|-----|--------------|-------|------|
| å‰ç«¯æ¡†æ¶ | **React + TailwindCSS** | Vue 3 + Vite | React ç”Ÿæ€æ›´æˆç†Ÿï¼ŒTailwind å¿«é€Ÿå¼€å‘ |
| çŠ¶æ€ç®¡ç† | **Zustand** | Redux Toolkit | è½»é‡ï¼Œå¤Ÿç”¨ |
| å›¾è¡¨ | **Recharts** | ECharts | React åŸç”Ÿï¼ŒAPI å‹å¥½ |
| åç«¯ | **ä¿æŒ FastAPI** | - | å·²æœ‰åŸºç¡€ï¼Œæ€§èƒ½å¥½ |
| å®æ—¶é€šä¿¡ | **SSE** | WebSocket | å•å‘æ¨é€è¶³å¤Ÿï¼Œå®ç°ç®€å• |
| æ•°æ®å­˜å‚¨ | **SQLite** | PostgreSQL | è½»é‡ï¼Œå•æœºéƒ¨ç½²å‹å¥½ |
| æ—¶åºæ•°æ® | **InfluxDB** | TimescaleDB | å¦‚æœéœ€è¦è¯¦ç»†å†å²åˆ†æ |
| éƒ¨ç½² | **Docker Compose** | systemd | ä¾¿äºè¿ç§»å’Œç®¡ç† |

---

## å››ã€é‡æ„è®¡åˆ’

### Phase 1: åç«¯ç»Ÿä¸€åŒ– (1-2 å¤©)

1. å¼•å…¥ç»Ÿä¸€è®¾å¤‡æ¨¡å‹
```python
# models/device.py
from enum import Enum
from pydantic import BaseModel
from typing import Optional, Any

class DeviceType(str, Enum):
    LIGHT = "light"
    SWITCH = "switch"
    HEATER = "heater"
    GARAGE_DOOR = "garage_door"

class DeviceState(BaseModel):
    id: str
    name: str
    type: DeviceType
    is_on: bool
    last_updated: Optional[str] = None
    extra: Optional[dict] = None  # è®¾å¤‡ç‰¹æœ‰å±æ€§
```

2. åˆ›å»ºç»Ÿä¸€çŠ¶æ€ API
```python
# api/status.py
@app.get("/api/status")
async def get_all_status() -> dict:
    return {
        "lights": await get_hue_status(),
        "switches": await get_wemo_status(),
        "heater": await get_rinnai_status(),
    }
```

3. æ·»åŠ  SSE æ¨é€
```python
@app.get("/api/events")
async def sse_events():
    async def event_generator():
        while True:
            data = await get_all_status()
            yield f"data: {json.dumps(data)}\n\n"
            await asyncio.sleep(5)
    return StreamingResponse(event_generator(), media_type="text/event-stream")
```

### Phase 2: å‰ç«¯ MVP (2-3 å¤©)

1. åˆå§‹åŒ– React é¡¹ç›®
2. å®ç°è®¾å¤‡å¡ç‰‡ç»„ä»¶
3. å®ç°æ§åˆ¶æŒ‰é’®
4. å®ç° SSE è¿æ¥
5. ç§»åŠ¨ç«¯å“åº”å¼

### Phase 3: å¢å¼º (3-5 å¤©)

1. å®šæ—¶ä»»åŠ¡ç®¡ç† UI
2. å†å²æ•°æ®å­˜å‚¨
3. è¶‹åŠ¿å›¾è¡¨
4. é€šçŸ¥ç³»ç»Ÿ

### Phase 4: éƒ¨ç½²ä¼˜åŒ– (1 å¤©)

1. Docker åŒ–
2. systemd æœåŠ¡
3. å¥åº·æ£€æŸ¥
4. æ—¥å¿—åˆ†çº§

---

## äº”ã€API è®¾è®¡

### 5.1 ç»Ÿä¸€ API ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|-----|------|------|
| `/api/status` | GET | è·å–æ‰€æœ‰è®¾å¤‡çŠ¶æ€ |
| `/api/events` | GET | SSE å®æ—¶æ¨é€ |
| `/api/devices` | GET | åˆ—å‡ºæ‰€æœ‰è®¾å¤‡ |
| `/api/devices/{id}` | GET | è·å–å•ä¸ªè®¾å¤‡è¯¦æƒ… |
| `/api/devices/{id}/on` | POST | å¼€å¯è®¾å¤‡ |
| `/api/devices/{id}/off` | POST | å…³é—­è®¾å¤‡ |
| `/api/devices/{id}/config` | PUT | æ›´æ–°è®¾å¤‡é…ç½® |
| `/api/schedules` | GET/POST | å®šæ—¶ä»»åŠ¡ç®¡ç† |
| `/api/history` | GET | å†å²æ•°æ®æŸ¥è¯¢ |

### 5.2 å“åº”æ ¼å¼

```json
{
  "status": "success",
  "timestamp": "2026-02-18T16:00:00Z",
  "data": { ... },
  "error": null
}
```

---

## å…­ã€é£é™©ä¸ç¼“è§£

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|-----|------|---------|
| Rinnai äº‘ç«¯ API ä¸ç¨³å®š | æ— æ³•æ§åˆ¶çƒ­æ°´å™¨ | æœ¬åœ°ç¼“å­˜ + é‡è¯• + é™çº§æ˜¾ç¤º |
| Wemo SSDP å‘ç°æ…¢ | é¡µé¢åŠ è½½æ…¢ | é¢„çƒ­ + æŒä¹…åŒ–è®¾å¤‡åˆ—è¡¨ |
| å‰ç«¯çŠ¶æ€ä¸ä¸€è‡´ | ç”¨æˆ·ä½“éªŒå·® | SSE + ä¹è§‚æ›´æ–° + å›æ»š |
| å†…ç½‘æš´éœ²é£é™© | å®‰å…¨é—®é¢˜ | API Key + å†…ç½‘é™åˆ¶ + å¯é€‰ VPN |

---

## ä¸ƒã€ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³å¯åš**: åˆ›å»º `api/status.py` ç»Ÿä¸€çŠ¶æ€æ¥å£
2. **æœ¬å‘¨å®Œæˆ**: å‰ç«¯ MVP éª¨æ¶
3. **æœ¬æœˆå®Œæˆ**: åŸºç¡€ Dashboard ä¸Šçº¿

---

## é™„å½•ï¼šç°æœ‰æ–‡ä»¶ç»“æ„

```
smart_home/
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡ (Hue + Rinnai)
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–
â”œâ”€â”€ main.py                 # FastAPI ä¸»ç¨‹åº
â”œâ”€â”€ wemo_schedule.py        # Wemo å®šæ—¶ä»»åŠ¡
â”œâ”€â”€ wemo_config.yaml        # Wemo è®¾å¤‡é…ç½®
â”œâ”€â”€ test_api.py             # Rinnai æµ‹è¯•
â”œâ”€â”€ create_schedule.py      # Rinnai Schedule åˆ›å»º
â”œâ”€â”€ introspect_schema.py    # GraphQL Schema æŸ¥è¯¢
â”œâ”€â”€ rinnai_skills.md        # Rinnai æŠ€æœ¯æ–‡æ¡£
â”œâ”€â”€ start_server.sh         # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ test/                   # æµ‹è¯•ç›®å½•
â”œâ”€â”€ docs/                   # æ–‡æ¡£ç›®å½•
â””â”€â”€ scripts/                # è„šæœ¬ç›®å½•
```

å»ºè®®æ–°å¢:
```
smart_home/
â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ device.py
â”œâ”€â”€ api/                    # API è·¯ç”±
â”‚   â”œâ”€â”€ status.py
â”‚   â””â”€â”€ events.py
â”œâ”€â”€ frontend/               # React å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ package.json
â””â”€â”€ data/                   # æ•°æ®å­˜å‚¨
    â””â”€â”€ history.db
```
